flowchart TD
    A[Start] --> B{Open Files};
    B --> C{Write Headers};
    C --> D{Read Record};
    D --> E{End of File?};
    E -- Yes --> F{Write Totals};
    F --> G{Close Files};
    G --> H[End];
    E -- No --> I{Accumulate Totals};
    I --> J{Format and Write Record};
    J --> D;